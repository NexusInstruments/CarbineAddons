<?xml version="1.0" encoding="UTF-8" standalone="yes" ?>
<Forms>
    <Form Class="Window" LAnchorPoint=".3" LAnchorOffset="-275" TAnchorPoint=".5" TAnchorOffset="-270" RAnchorPoint=".3" RAnchorOffset="149" BAnchorPoint=".5" BAnchorOffset="270" RelativeToClient="1" Font="Default" Text="" Template="Default" Name="NonCombatSpellbookForm" Border="0" Picture="0" SwallowMouseClicks="1" Moveable="1" Escapable="1" Overlapped="1" BGColor="ffffffff" TextColor="ffffffff" TextId="" TooltipColor="" Tooltip="">
        <Control Class="Window" LAnchorPoint="0" LAnchorOffset="24" TAnchorPoint="0" TAnchorOffset="135" RAnchorPoint="0" RAnchorOffset="400" BAnchorPoint="0" BAnchorOffset="520" RelativeToClient="1" Font="Default" Text="" BGColor="UI_WindowBGDefault" TextColor="UI_WindowTextDefault" Template="Holo_Background_General" TooltipType="OnCursor" Name="Window" TooltipColor="" Border="1" IgnoreMouse="1" UseTemplateBG="1"/>
        <Control Class="Window" LAnchorPoint="0" LAnchorOffset="29" TAnchorPoint="0" TAnchorOffset="110" RAnchorPoint="1" RAnchorOffset="-27" BAnchorPoint="1" BAnchorOffset="-22" RelativeToClient="1" Font="Default" Text="" Template="Default" TooltipType="OnCursor" Name="Entries" BGColor="ffffffff" TextColor="ffffffff" TooltipColor="" Sprite="" Picture="1" IgnoreMouse="1" HideInEditor="0" Visible="1" Tooltip="" NewControlDepth="1">
            <Control Class="Window" LAnchorPoint="0" LAnchorOffset="9" TAnchorPoint="0" TAnchorOffset="40" RAnchorPoint="1" RAnchorOffset="-12" BAnchorPoint="1" BAnchorOffset="-45" RelativeToClient="1" Font="CRB_InterfaceSmall_O" Text="" Template="Holo_ScrollList" Name="EntriesContainer" BGColor="ffffffff" TextColor="UI_TextHoloBody" VScroll="1" IgnoreMouse="0" TooltipColor="" Visible="1" TransitionShowHide="0" HideInEditor="0" VScrollLeftSide="0" AutoHideScroll="0" DT_CENTER="1" DT_VCENTER="1" Picture="1" Border="1" UseTemplateBG="1"/>
            <Control Class="Window" LAnchorPoint="0" LAnchorOffset="9" TAnchorPoint="0" TAnchorOffset="40" RAnchorPoint="1" RAnchorOffset="-12" BAnchorPoint="1" BAnchorOffset="-45" RelativeToClient="1" Font="CRB_InterfaceSmall_O" Text="" Template="Holo_ScrollList" Name="EntriesContainerMisc" BGColor="ffffffff" TextColor="UI_TextHoloBody" VScroll="1" IgnoreMouse="0" TooltipColor="" Visible="1" TransitionShowHide="0" HideInEditor="0" VScrollLeftSide="0" AutoHideScroll="0" DT_CENTER="1" DT_VCENTER="1" Picture="1" Border="1" UseTemplateBG="1"/>
            <Control Class="Window" LAnchorPoint="0" LAnchorOffset="8" TAnchorPoint="1" TAnchorOffset="-42" RAnchorPoint="1" RAnchorOffset="-11" BAnchorPoint="1" BAnchorOffset="-15" RelativeToClient="1" Font="CRB_InterfaceSmall" Text="" Template="Default" TooltipType="OnCursor" Name="EntiresExplainerText" BGColor="ffffffff" TextColor="UI_TextHoloBodyHighlight" TooltipColor="" Picture="1" IgnoreMouse="1" Sprite="BK3:UI_BK3_Holo_InsetSimple" TextId="NCSpellbook_DragToBar" DT_WORDBREAK="0" DT_CENTER="1" DT_VCENTER="1" NewControlDepth="1" AutoScaleTextOff="0"/>
        </Control>
        <Control Class="Button" Base="CRB_Basekit:kitBtn_Close" Font="Thick" ButtonType="PushButton" RadioGroup="" LAnchorPoint="1" LAnchorOffset="-52" TAnchorPoint="0" TAnchorOffset="25" RAnchorPoint="1" RAnchorOffset="-25" BAnchorPoint="0" BAnchorOffset="54" DT_VCENTER="1" DT_CENTER="1" Name="CloseButton" BGColor="ffffffff" TextColor="ffffffff" NewControlDepth="2" WindowSoundTemplate="CloseWindowPhys" Text="" TextId="" NormalTextColor="ffffffff" PressedTextColor="ffffffff" FlybyTextColor="ffffffff" PressedFlybyTextColor="ffffffff" DisabledTextColor="ffffffff" TooltipColor="" RelativeToClient="1">
            <Event Name="ButtonSignal" Function="OnClose"/>
        </Control>
        <Control Class="Window" LAnchorPoint="0" LAnchorOffset="0" TAnchorPoint="0" TAnchorOffset="0" RAnchorPoint="1" RAnchorOffset="0" BAnchorPoint="1" BAnchorOffset="0" RelativeToClient="1" Font="Default" Text="" BGColor="UI_WindowBGDefault" TextColor="UI_WindowTextDefault" Template="Metal_Primary_Nav" TooltipType="OnCursor" Name="MainBG" TooltipColor="" Border="1" IgnoreMouse="1" Picture="0" UseTemplateBG="1" HideInEditor="1"/>
        <Control Class="Window" LAnchorPoint=".5" LAnchorOffset="-150" TAnchorPoint="0" TAnchorOffset="27" RAnchorPoint=".5" RAnchorOffset="150" BAnchorPoint="0" BAnchorOffset="63" RelativeToClient="1" Font="CRB_HeaderMedium" Text="" BGColor="UI_WindowBGDefault" TextColor="UI_WindowTitleYellow" Template="Default" TooltipType="OnCursor" Name="Header" TooltipColor="" Sprite="BK3:sprMetal_Framing_Header" Picture="1" IgnoreMouse="1" TextId="InterfaceMenu_NonCombatAbilities" DT_CENTER="1" DT_VCENTER="1" NewControlDepth="1" AutoScaleText="1"/>
        <Control Class="Window" LAnchorPoint="0" LAnchorOffset="26" TAnchorPoint="0" TAnchorOffset="49" RAnchorPoint="0" RAnchorOffset="406" BAnchorPoint="0" BAnchorOffset="124" RelativeToClient="1" Font="Default" Text="" Template="Default" TooltipType="OnCursor" Name="Tabs" BGColor="ffffffff" TextColor="ffffffff" TooltipColor="" Picture="1" IgnoreMouse="1" Sprite="" DT_CENTER="1" DT_VCENTER="1" TextId="" HideInEditor="0" NewControlDepth="2">
            <Control Class="Window" LAnchorPoint="0" LAnchorOffset="0" TAnchorPoint="0" TAnchorOffset="0" RAnchorPoint="1" RAnchorOffset="0" BAnchorPoint="1" BAnchorOffset="0" RelativeToClient="1" Font="Default" Text="" Template="Default" TooltipType="OnCursor" Name="TabsContainer" BGColor="ffffffff" TextColor="ffffffff" TooltipColor="" Tooltip="">
                <Control Class="Button" Base="BK3:btnMetal_TabMainLeft" Font="CRB_ButtonHeader" ButtonType="Check" RadioGroup="" LAnchorPoint="0" LAnchorOffset="0" TAnchorPoint="0" TAnchorOffset="0" RAnchorPoint=".5" RAnchorOffset="0" BAnchorPoint="1" BAnchorOffset="0" DT_VCENTER="1" DT_CENTER="1" TooltipType="OnCursor" Name="BankTabBtnCmd" BGColor="ffffffff" TextColor="ffffffff" TooltipColor="" NormalTextColor="UI_BtnTextGoldListNormal" PressedTextColor="UI_BtnTextGoldListPressed" FlybyTextColor="UI_BtnTextGoldListFlyby" PressedFlybyTextColor="UI_BtnTextGoldListPressedFlyby" DisabledTextColor="UI_BtnTextGoldListDisabled" Text="" TextId="CRB_Commands" GlobalRadioGroup="GuildBank_BigBankTab_RadioGroup" RelativeToClient="1" RadioDisallowNonSelection="1" HideInEditor="0" Visible="1">
                    <Event Name="ButtonCheck" Function="OnTabBtnCheck"/>
                </Control>
                <Control Class="Button" Base="BK3:btnMetal_TabMainRight" Font="CRB_ButtonHeader" ButtonType="Check" RadioGroup="" LAnchorPoint=".5" LAnchorOffset="0" TAnchorPoint="0" TAnchorOffset="0" RAnchorPoint="0" RAnchorOffset="373" BAnchorPoint="1" BAnchorOffset="0" DT_VCENTER="1" DT_CENTER="1" TooltipType="OnCursor" Name="BankTabBtnMisc" BGColor="ffffffff" TextColor="ffffffff" TooltipColor="" NormalTextColor="UI_BtnTextGoldListNormal" PressedTextColor="UI_BtnTextGoldListPressed" FlybyTextColor="UI_BtnTextGoldListFlyby" PressedFlybyTextColor="UI_BtnTextGoldListPressedFlyby" DisabledTextColor="UI_BtnTextGoldListDisabled" Text="" TextId="CRB_Miscellaneous" GlobalRadioGroup="GuildBank_BigBankTab_RadioGroup" RelativeToClient="1" RadioDisallowNonSelection="1" Visible="1" HideInEditor="0">
                    <Event Name="ButtonCheck" Function="OnTabBtnCheck"/>
                </Control>
            </Control>
        </Control>
    </Form>
    <Form Class="Window" LAnchorPoint="0" LAnchorOffset="0" TAnchorPoint="0" TAnchorOffset="0" RAnchorPoint="1" RAnchorOffset="0" BAnchorPoint="0" BAnchorOffset="50" RelativeToClient="1" Font="Default" Text="" Template="Default" TooltipType="OnCursor" Name="SpellEntry" Border="0" Picture="1" SwallowMouseClicks="1" Moveable="0" Escapable="0" Overlapped="0" BGColor="ffffffff" TextColor="ffffffff" TooltipColor="" Tooltip="">
        <Control Class="Window" LAnchorPoint="0" LAnchorOffset="55" TAnchorPoint="0" TAnchorOffset="0" RAnchorPoint="1" RAnchorOffset="0" BAnchorPoint="1" BAnchorOffset="0" RelativeToClient="1" Font="CRB_InterfaceMedium_B" Text="" Template="Default" TooltipType="OnCursor" Name="Title" BGColor="ffffffff" TextColor="UI_TextHoloBody" TooltipColor="" TextId="Challenges_NoProgress" DT_RIGHT="0" DT_VCENTER="1"/>
        <Control Class="Window" LAnchorPoint="0" LAnchorOffset="5" TAnchorPoint="0" TAnchorOffset="5" RAnchorPoint="0" RAnchorOffset="45" BAnchorPoint="1" BAnchorOffset="-5" RelativeToClient="1" Font="Default" Text="" Template="Default" TooltipType="OnCursor" Name="IconBG" BGColor="ffffffff" TextColor="ffffffff" TooltipColor="" Border="0" IgnoreMouse="1" Picture="1" Sprite="CRB_Basekit:kitBase_HoloBlue_Tiny" NoClip="0" Visible="1" HideInEditor="0" TextId="" NewWindowDepth="1"/>
        <Control Class="ActionBarButton" Base="Button_ActionBarBlank" RelativeToClient="1" IfHoldNoSignal="1" DT_VCENTER="1" DT_CENTER="1" NeverBringToFront="0" Picture="1" WindowSoundTemplate="ActionBarButton" LAnchorPoint="0" LAnchorOffset="10" TAnchorPoint="0" TAnchorOffset="10" RAnchorPoint="0" RAnchorOffset="40" BAnchorPoint="0" BAnchorOffset="40" IgnoreTooltipDelay="0" TooltipType="OnCursor" Name="ActionBarButton" BGColor="ffffffff" TextColor="ffffffff" TooltipColor="" ProcessRightClick="1" ContentId="0" IgnoreMouse="0" NewWindowDepth="1" Tooltip="">
            <Event Name="QueryBeginDragDrop" Function="OnBeginDragDrop"/>
        </Control>
        <Control Class="Window" LAnchorPoint="0" LAnchorOffset="0" TAnchorPoint="0" TAnchorOffset="0" RAnchorPoint="1" RAnchorOffset="0" BAnchorPoint="1" BAnchorOffset="0" RelativeToClient="1" Font="Default" Text="" BGColor="UI_WindowBGDefault" TextColor="UI_WindowTextDefault" Template="Default" TooltipType="OnCursor" Name="Window" TooltipColor="" Sprite="BK3:btnHolo_ListView_MidDisabled" Picture="1" IgnoreMouse="1"/>
    </Form>
    <Form Class="Window" LAnchorPoint="0" LAnchorOffset="0" TAnchorPoint="0" TAnchorOffset="0" RAnchorPoint="1" RAnchorOffset="0" BAnchorPoint="0" BAnchorOffset="50" RelativeToClient="1" Font="Default" Text="" Template="Default" TooltipType="OnCursor" Name="GameCommandEntry" Border="0" Picture="0" SwallowMouseClicks="1" Moveable="0" Escapable="0" Overlapped="0" BGColor="ffffffff" TextColor="ffffffff" TooltipColor="" Tooltip="">
        <Control Class="Window" LAnchorPoint="0" LAnchorOffset="55" TAnchorPoint="0" TAnchorOffset="0" RAnchorPoint="1" RAnchorOffset="0" BAnchorPoint="1" BAnchorOffset="0" RelativeToClient="1" Font="CRB_InterfaceMedium_B" Text="" Template="Default" TooltipType="OnCursor" Name="Title" BGColor="ffffffff" TextColor="UI_TextHoloBody" TooltipColor="" TextId="Challenges_NoProgress" DT_RIGHT="0" DT_VCENTER="1"/>
        <Control Class="Window" LAnchorPoint="0" LAnchorOffset="5" TAnchorPoint="0" TAnchorOffset="5" RAnchorPoint="0" RAnchorOffset="45" BAnchorPoint="1" BAnchorOffset="-5" RelativeToClient="1" Font="Default" Text="" Template="Default" TooltipType="OnCursor" Name="IconBG" BGColor="ffffffff" TextColor="ffffffff" TooltipColor="" Border="0" IgnoreMouse="1" Picture="1" Sprite="CRB_Basekit:kitBase_HoloBlue_Tiny" NoClip="0" Visible="1" HideInEditor="0" TextId="" NewWindowDepth="1"/>
        <Control Class="ActionBarButton" Base="Button_ActionBarBlank" RelativeToClient="1" IfHoldNoSignal="1" DT_VCENTER="1" DT_CENTER="1" NeverBringToFront="0" Picture="1" WindowSoundTemplate="ActionBarButton" LAnchorPoint="0" LAnchorOffset="10" TAnchorPoint="0" TAnchorOffset="10" RAnchorPoint="0" RAnchorOffset="40" BAnchorPoint="0" BAnchorOffset="40" IgnoreTooltipDelay="0" TooltipType="OnCursor" Name="ActionBarButton" BGColor="ffffffff" TextColor="ffffffff" TooltipColor="" ProcessRightClick="1" ContentId="0" IgnoreMouse="0" NewWindowDepth="1" Tooltip="" ContentType="GCBar">
            <Event Name="QueryBeginDragDrop" Function="OnBeginCmdDragDrop"/>
            <Event Name="GenerateTooltip" Function="OnGenerateTooltip"/>
        </Control>
        <Control Class="Window" LAnchorPoint="0" LAnchorOffset="0" TAnchorPoint="0" TAnchorOffset="0" RAnchorPoint="1" RAnchorOffset="0" BAnchorPoint="1" BAnchorOffset="0" RelativeToClient="1" Font="Default" Text="" BGColor="UI_WindowBGDefault" TextColor="UI_WindowTextDefault" Template="Default" TooltipType="OnCursor" Name="Window" TooltipColor="" Sprite="BK3:btnHolo_ListView_MidDisabled" Picture="1" IgnoreMouse="1"/>
    </Form>
</Forms>
e(iPercent)
	return iPercent * 2.4
end
-- Interact with NPC ----------------------------------------------------------------------------------------------------------
function NCCB:Interact(text, bartype, speed, sweetspot, width1, width2)
--	Apollo.DPF("Interact text:      " ..text)
--	Apollo.DPF("Interact bartype:   " ..bartype)
--	Apollo.DPF("Interact speed:     " ..speed)
--	Apollo.DPF("Interact sweetspot: " .. sweetspot)
--	Apollo.DPF("Interact width1:    " ..width1)
--	Apollo.DPF("Interact width2:    " ..width2)
	
	self.NCCB:FindChild("CastingProgress"):SetBarColor(CColor.new(0.0, 0.0, 2.0, 1.0))
	self.Test:FindChild("ChannelBtn"):Show(false)
	self.Test:FindChild("DrainBtn"):Show(false)
	self.Test:FindChild("TapBtn"):Show(false)
	self.Test:FindChild("LayeredTapBtn"):Show(false)
	self.Test:FindChild("HoldBtn"):Show(false)
	self.Test:FindChild("RapidBtn"):Show(false)	
	
	self.tEvent.Duration = speed / 1000
	
	if self.Test:IsVisible() == false then
		self.Test:Show(true)
	else
		self.Test:Show(false)
	end
	
	if bartype == 0 then
		self.Test:FindChild("HoldBtn"):Show(true)
		
		if sweetspot > 5 or sweetspot < 0 then
			--Apollo.DPF("Invalid input: Please enter a number from 1-5")
		else
			self.tEvent.SweetSpot = sweetspot
		end
		
	elseif bartype == 1 then
		self.Test:FindChild("TapBtn"):Show(true)		
		self.tEvent.BarText = text
		self.tEvent.SweetSpot = sweetspot
		self.tEvent.Width1 = self:ConvertFromPercentage(width1)
		self.tEvent.Layered = false
		
		self.Box1:Move(self.l, self.t, self.w, self.h)
		self.Box2:Move(self.l2, self.t2, self.w2, self.h2)
		
	elseif bartype == 2 then
		self.Test:FindChild("LayeredTapBtn"):Show(true)
		self.tEvent.BarText = text
		self.tEvent.SweetSpot = sweetspot
		self.tEvent.Width1 = self:ConvertFromPercentage(width1)
		self.tEvent.Width2 = self:ConvertFromPercentage(width2)
		
		self.Box1:Move(self.l, self.t, self.w, self.h)
		self.Box2:Move(self.l2, self.t2, self.w2, self.h2)
		
	elseif bartype == 3 then
		self.Test:FindChild("RapidBtn"):Show(true)
	end
end

local NCCBInstance = NCCB:new()
NCCBInstance:Init()ipColo# ! hRH.H IgnoreMouse="1" Sprite="BK3:UI_BK3_Holo_InsetSimple" NewWindowDepth="1" Tooltip=""/>
        <Control Class="Window" LAnchorPoint="0" LAnchorOffset="10" TAnchorPoint="0" TAnchorOffset="11" RAnchorPoint="0" RAnchorOffset="42" BAnchorPoint="0" BAnchorOffset="43" RelativeToClient="0" Font="Default" Text="" Template="Default" TooltipType="OnCursor" Name="ItemIcon" BGColor="ffffffff" TextColor="ffffffff" TooltipColor="" Picture="1" IgnoreMouse="1" Sprite="" NewWindowDepth="1" Tooltip="" Subclass="ItemWindowSubclass" WindowTextYMargin="2" WindowTextXMargin="2" DT_RIGHT="1" DT_BOTTOM="1"/>
        <Control Class="Window" LAnchorPoint="0" LAnchorOffset="55" TAnchorPoint=".5" TAnchorOffset="-20" RAnchorPoint="1" RAnchorOffset="-38" BAnchorPoint=".5" BAnchorOffset="20" RelativeToClient="0" Font="CRB_InterfaceSmall" Text="" Template="Default" TooltipType="OnCursor" Name="ItemName" BGColor="ffffffff" TextColor="UI_TextHoloBodyHighlight" TooltipColor="" TextId="Challenges_NoProgress" HideInEditor="0" Tooltip="" DT_VCENTER="1" IgnoreMouse="1" NewWindowDepth="1" DT_WORDBREAK="1" AutoScaleText="1"/>
        <Event Name="MouseButtonUp" Function="OnItemMouseButtonUp"/>
        <Event Name="GenerateTooltip" Function="OnItemGenerateTooltip"/>
    </Form>
</Forms>
 ? X I75iuu.[as}wTSz0M{r<߱#u~-up5}޼qM{>F8nyO1T&ϩ|8U&-R⸉A\~<a	~0母TƺPås.Kx0uoUoF2y(SPky,u}uwSl]z$cZY͟I+7CwՉ:V=:P|hK(|ەv^cWhuύyOD~gK8ӡ8n乫.p35,5ד;OGT8h^{"plpjzصW9Z^:^仯/֏:v;SX{s)xXqW]n⹳|>X><έ{s.5/.eu2U~W9^۝3K}y|<mm?b#yD܆74myqz"*}W{ݖ_γv[ۮayy,P#